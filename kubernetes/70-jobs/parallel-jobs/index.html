<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus">


<title data-react-helmet="true">Parallel Jobs | Kubernetes Training</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Kubernetes Training"><meta data-react-helmet="true" property="og:image" content="https://anynines.github.io/img/logo.svg"><meta data-react-helmet="true" property="twitter:image" content="https://anynines.github.io/img/logo.svg"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Kubernetes Training"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" name="description" content="In this lesson you will learn about executing tasks in parallel by running multiple Pods simultaneously."><meta data-react-helmet="true" property="og:description" content="In this lesson you will learn about executing tasks in parallel by running multiple Pods simultaneously."><meta data-react-helmet="true" property="og:url" content="https://anynines.github.io/kubernetes/70-jobs/parallel-jobs">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico">


<link rel="stylesheet" href="/styles.67168085.css">


<link rel="preload" href="/styles.066538b2.js" as="script">

<link rel="preload" href="/runtime~main.e4a02f97.js" as="script">

<link rel="preload" href="/main.f2f4a6b2.js" as="script">

<link rel="preload" href="/1.c0bed9a4.js" as="script">

<link rel="preload" href="/37.3f9923b7.js" as="script">

<link rel="preload" href="/ec1ed54d.2f80c337.js" as="script">

<link rel="preload" href="/17896441.fa0e84b7.js" as="script">

<link rel="preload" href="/16b979bf.084cfda4.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/training-overview"><img class="navbar__logo" src="/img/logo.svg" alt="anynines"><strong class="navbar__title">Kubernetes Training</strong></a><a class="navbar__item navbar__link" href="/containerization/container-overview">Container Training</a><a class="navbar__item navbar__link" href="/kubernetes/kubernetes-overview">Kubernetes Training</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/anynines">GitHub</a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://paas.anynines.com">anynines PaaS</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/training-overview"><img class="navbar__logo" src="/img/logo.svg" alt="anynines"><strong class="navbar__title">Kubernetes Training</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/containerization/container-overview">Container Training</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/kubernetes-overview">Kubernetes Training</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://github.com/anynines">GitHub</a></li><li class="menu__list-item"><a class="menu__link" target="_blank" rel="noopener noreferrer" href="https://paas.anynines.com">anynines PaaS</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="sidebarLogo_3ono"><img src="/img/logo.svg" alt="anynines"><strong>Kubernetes Training</strong></div><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/training-overview">Kubernetes Training Overview</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Containerization</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/containerization/container-overview">Container Overview</a></li><li class="menu__list-item"><a class="menu__link" href="/containerization/container-intro">Containers Basics</a></li><li class="menu__list-item"><a class="menu__link" href="#!">Docker</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docker/installation">Docker Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docker/docker-basics">Docker Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/docker/creating-images">Creating Container Images</a></li><li class="menu__list-item"><a class="menu__link" href="/docker/simple-web-app">Containerizing a Simple Web App</a></li><li class="menu__list-item"><a class="menu__link" href="/docker/publish-image">Publishing a Container Image</a></li><li class="menu__list-item"><a class="menu__link" href="/docker/container-workflow">The Container Workflow</a></li><li class="menu__list-item"><a class="menu__link" href="/docker/docker-cheatsheet">Docker Cheat Sheet</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kubernetes/kubernetes-overview">Kubernetes Overview</a></li><li class="menu__list-item"><a class="menu__link" href="#!">Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kubernetes/10-basics/kubectl">kubectl Basics</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/10-basics/namespaces">Namespaces</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/10-basics/container-shell">Container Shell Access</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Pods</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kubernetes/20-pods/introduction">Pods</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">ReplicaSets and Services</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kubernetes/40-replicaset-and-service/introduction">ReplicaSets and Services</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/40-replicaset-and-service/replicasets">ReplicaSets</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/40-replicaset-and-service/services">Services</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/40-replicaset-and-service/ingress">Ingress</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/40-replicaset-and-service/tidyup">Tyding Up</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Deployments</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kubernetes/50-deployments/deployments">Deployments</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">ConfigMaps and Secrets</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kubernetes/60-configmaps-and-secrets/configmaps-and-secrets">ConfigMaps and Secrets</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/60-configmaps-and-secrets/configmaps">ConfigMaps</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/60-configmaps-and-secrets/exercise-explanation">Exercise Explanation</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/60-configmaps-and-secrets/configmaps-volume-mounts">ConfigMap Volume Mounts</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/60-configmaps-and-secrets/secrets">Secrets</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/60-configmaps-and-secrets/secrets-exercise-explanation">Secrets Exercise Explanation</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="#!">Jobs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/kubernetes/70-jobs/jobs">Jobs</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/70-jobs/advanced-jobs">Advanced Job Features</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/kubernetes/70-jobs/parallel-jobs">Parallel Jobs</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/70-jobs/cron-jobs">CronJobs</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="padding-vert--lg"><div class="container"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Parallel Jobs</h1></header><div class="markdown"><p>In this lesson you will learn about executing tasks in parallel by running multiple Pods simultaneously.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="job-completion-count"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#job-completion-count" title="Direct link to heading">#</a>Job Completion Count</h2><p>In the previous example using <code>kubectl get jobs</code> you may have noticed the field <code>COMPLETIONS</code> whose value was <code>1/1</code> in case a Job has been completed successfully. More precisely, the count determines the number of successful Pod executions as part of the Job. In case of a failing a Job, the failing Pod has been recreated and the completion count has been reached even though the source code describe the task has been very unreliable.</p><p>There are tasks requiring more than one iteration to fully accomplish the underlying objective. For this purpose Kubernetes Jobs allow to specify the number of desired completions, e.g. 2 completions by adding <code>completions: 2</code>.</p><p>Let&#x27;s try it out! Create the file <code>60-simple-job-two-completions.yaml</code>:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-YAML codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: batch/v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kind: Job</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name: one-off-job-two-completions</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  completions: 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  template:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      containers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - name: simple-one-off-job-container</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        image: busybox</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        imagePullPolicy: Always</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        command: [&quot;echo&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        args:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        - &quot;I represent a very important maintenance task&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      restartPolicy: OnFailure</span></div></code></pre></div><p>And apply it:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f 60-simple-job-two-completions.yaml</span></div></code></pre></div><p>While the Job is running observe its Pods by opening another terminal so you can paste the observation command immediately after executing it. Ideally, you have the command already in your clipboard (CTRL+C):</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get pods -l job-name=one-off-job-two-completions -w</span></div></code></pre></div><p>You should see two Pods. If things happen too fast increase the number of completions to gain more observation time.</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                                READY   STATUS            RESTARTS   AGE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-xzhmh   0/1     Pending             0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-xzhmh   0/1     Pending             0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-xzhmh   0/1     ContainerCreating   0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-xzhmh   0/1     Completed           0          3s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-pb44m   0/1     Pending             0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-pb44m   0/1     Pending             0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-pb44m   0/1     ContainerCreating   0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-pb44m   0/1     Completed           0          3s</span></div></code></pre></div><p>A close observation also reveals that <strong>the Pods run in sequence</strong>. This may be desired if the task requires ordinality and the execution sequence matters to the the task outcome. However, if there is no ordinality requirement <strong>running the Jobs Pods in sequence is a waste of time</strong>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="parallel-job-execution"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#parallel-job-execution" title="Direct link to heading">#</a>Parallel Job Execution</h2><p>Luckily Kubernets supports parallel Job execution out of the box. Changing the Job definition to enable parallelism is as easy as pie by adding a spec attributed <code>parallelism: 2</code>.</p><p>Create the Job description in file <code>70-simple-job-two-completions-parallel.yaml</code>:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-YAML codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">apiVersion: batch/v1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kind: Job</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">metadata:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  name: one-off-job-two-completions-parallel</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  completions: 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  parallelism: 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  template:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    spec:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      containers:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      - name: simple-one-off-job-container</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        image: busybox</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        imagePullPolicy: Always</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        command: [&quot;echo&quot;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        args:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        - &quot;I represent a very important maintenance task&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      restartPolicy: OnFailure</span></div></code></pre></div><p>Running the Job:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f 70-simple-job-two-completions-parallel.yaml</span></div></code></pre></div><p>And observing the result:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get pods -l job-name=one-off-job-two-completions-parallel -w</span></div></code></pre></div><p>The output looks similar to:</p><div class="mdxCodeBlock_iHAB"><pre class="prism-code language-undefined codeBlock_19pQ"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><code class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">NAME                                         READY   STATUS    RESTARTS   AGE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-parallel-s2j5k   0/1     Pending             0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-parallel-s2j5k   0/1     Pending             0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-parallel-qknz4   0/1     Pending             0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-parallel-qknz4   0/1     Pending             0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-parallel-s2j5k   0/1     ContainerCreating   0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-parallel-qknz4   0/1     ContainerCreating   0          0s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-parallel-s2j5k   0/1     Completed           0          3s</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">one-off-job-two-completions-parallel-qknz4   0/1     Completed           0          3s</span></div></code></pre></div><p>Compare the outputs of the <em>first non-parallel</em> and <em>second parallel</em> run. </p><p>The <em>first run</em> the sequence was: <code>Pending, Pending, ContainerCreating, Completed, ContainerCreating, Completed</code> which implies sequential execution.</p><p>The <em>second run</em> shows parallel execution with the sequence: <code>Pending, Pending, ContainerCreating, ContainerCreating, Completed, Completed</code>.</p><p>As you can see <strong>it is fairly easy to define iterative, parallel Jobs using Kubernetes</strong>.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kubernetes/70-jobs/advanced-jobs"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Advanced Job Features</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kubernetes/70-jobs/cron-jobs"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">CronJobs »</h4></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#job-completion-count" class="contents__link">Job Completion Count</a></li><li><a href="#parallel-job-execution" class="contents__link">Parallel Job Execution</a></li></ul></div></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="text--center"><div class="margin-bottom--sm"><a href="https://anynines.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1Wg7"><img class="footer__logo" alt="anynines" src="/img/logo.svg"></a></div><div>Copyright © 2020 anynines GmbH.</div></div></div></footer>
</div>

<script src="/styles.066538b2.js"></script>

<script src="/runtime~main.e4a02f97.js"></script>

<script src="/main.f2f4a6b2.js"></script>

<script src="/1.c0bed9a4.js"></script>

<script src="/37.3f9923b7.js"></script>

<script src="/ec1ed54d.2f80c337.js"></script>

<script src="/17896441.fa0e84b7.js"></script>

<script src="/16b979bf.084cfda4.js"></script>


</body>
</html>
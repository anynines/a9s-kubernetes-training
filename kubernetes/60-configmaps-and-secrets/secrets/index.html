<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<title data-react-helmet="true">Secrets | Kubernetes Training</title><meta data-react-helmet="true" property="og:image" content="https://anynines.github.io/img/logo.svg"><meta data-react-helmet="true" property="twitter:image" content="https://anynines.github.io/img/logo.svg"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Kubernetes Training"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Secrets | Kubernetes Training"><meta data-react-helmet="true" name="description" content="Secrets are represented as key value pair and thus are very similar to ConfigMaps. However, ConfigMaps are meant for non-sensitive configuration data aiming at making application code portable across environments. So - analog to ConfigMaps - Secrets are key value sets but for sensitive data."><meta data-react-helmet="true" property="og:description" content="Secrets are represented as key value pair and thus are very similar to ConfigMaps. However, ConfigMaps are meant for non-sensitive configuration data aiming at making application code portable across environments. So - analog to ConfigMaps - Secrets are key value sets but for sensitive data."><meta data-react-helmet="true" property="og:url" content="https://anynines.github.io/kubernetes/60-configmaps-and-secrets/secrets"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://anynines.github.io/kubernetes/60-configmaps-and-secrets/secrets"><link rel="stylesheet" href="/styles.3242ed13.css">
<link rel="preload" href="/styles.3e1a9644.js" as="script">
<link rel="preload" href="/runtime~main.4b91e377.js" as="script">
<link rel="preload" href="/main.43f40134.js" as="script">
<link rel="preload" href="/1.040ff6b2.js" as="script">
<link rel="preload" href="/2.9decab9e.js" as="script">
<link rel="preload" href="/62.da6d2fa3.js" as="script">
<link rel="preload" href="/61.482bd80b.js" as="script">
<link rel="preload" href="/ec1ed54d.cede18ae.js" as="script">
<link rel="preload" href="/17896441.6d66ffd8.js" as="script">
<link rel="preload" href="/6cbc433d.3c96948e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/training-overview"><img class="navbar__logo" src="/img/logo.svg" alt="anynines"><strong class="navbar__title">Kubernetes Training</strong></a><a class="navbar__item navbar__link" href="/containerization/container-overview">Container Training</a><a class="navbar__item navbar__link" href="/kubernetes/kubernetes-overview">Kubernetes Training</a><a class="navbar__item navbar__link" href="/postgresql/postgresql-overview">PostgreSQL on Kubernetes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/anynines" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://paas.anynines.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">anynines PaaS</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/training-overview"><img class="navbar__logo" src="/img/logo.svg" alt="anynines"><strong class="navbar__title">Kubernetes Training</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/containerization/container-overview">Container Training</a></li><li class="menu__list-item"><a class="menu__link" href="/kubernetes/kubernetes-overview">Kubernetes Training</a></li><li class="menu__list-item"><a class="menu__link" href="/postgresql/postgresql-overview">PostgreSQL on Kubernetes</a></li><li class="menu__list-item"><a href="https://github.com/anynines" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://paas.anynines.com" target="_blank" rel="noopener noreferrer" class="menu__link">anynines PaaS</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/training-overview">Kubernetes Training Overview</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe">Containerization</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/containerization/container-overview">Container Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/containerization/container-intro">Containers Basics</a></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">Docker</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docker/installation">Docker Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docker/docker-basics">Docker Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docker/creating-images">Creating Container Images</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docker/simple-web-app">Containerizing a Simple Web App</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docker/publish-image">Publishing a Container Image</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docker/container-workflow">The Container Workflow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docker/docker-cheatsheet">Docker Cheat Sheet</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe">Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/kubernetes-overview">Kubernetes Overview</a></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/10-basics/kubectl">kubectl Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/10-basics/namespaces">Namespaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/10-basics/container-shell">Container Shell Access</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">Pods</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/20-pods/introduction">Pods</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">ReplicaSets and Services</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/40-replicaset-and-service/introduction">ReplicaSets and Services</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/40-replicaset-and-service/replicasets">ReplicaSets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/40-replicaset-and-service/services">Services</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/40-replicaset-and-service/ingress">Ingress</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/40-replicaset-and-service/tidyup">Tyding Up</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">Deployments</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/50-deployments/deployments">Deployments</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">ConfigMaps and Secrets</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/60-configmaps-and-secrets/configmaps-and-secrets">ConfigMaps and Secrets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/60-configmaps-and-secrets/configmaps">ConfigMaps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/60-configmaps-and-secrets/exercise-explanation">Exercise Explanation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/60-configmaps-and-secrets/configmaps-volume-mounts">ConfigMap Volume Mounts</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/kubernetes/60-configmaps-and-secrets/secrets">Secrets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/60-configmaps-and-secrets/secrets-exercise-explanation">Secrets Exercise Explanation</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">Jobs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/70-jobs/jobs">Jobs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/70-jobs/advanced-jobs">Advanced Job Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/70-jobs/parallel-jobs">Parallel Jobs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/70-jobs/cron-jobs">CronJobs</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">StatefulSets</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/80-stateful-sets/persistent-volumes">Persistent Volumes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/80-stateful-sets/persistent-volumes-exercise">Persistent Volumes Excercise</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/80-stateful-sets/stateful-sets">StatefulSets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/80-stateful-sets/stateful-set-postgresql">PostgreSQL StatefulSet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/80-stateful-sets/stateful-set-headless-service">Headless Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/80-stateful-sets/stateful-set-vs-replicasets">StatefulSet vs. ReplicaSets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/80-stateful-sets/stateful-set-psql-access-to-postgresql">PSQL Access to PostgreSQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/80-stateful-sets/stateful-set-application-access">Application Access to a StatefulSet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/80-stateful-sets/stateful-set-conclusions">Conclusions</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe">PostgreSQL on Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/postgresql-overview">Overview</a></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">PostgreSQL Replication</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/20-postgresql-theory/why-use-replication">Why use Replication?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/20-postgresql-theory/replication-outline">Replication Outline</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/20-postgresql-theory/streaming-replication">PostgreSQL Streaming Replication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/20-postgresql-theory/setting-up-streaming-replication">Setting up Streaming Replication</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2sSe" tabindex="0">StatefulSet with Replication</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/30-stateful-sets-revisited/stateful-sets-revisited">StatefulSets Revisited</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/40-building-the-pg-stateful-set/pg-service-primary">Service to Connnect to the Primary</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/40-building-the-pg-stateful-set/streaming-replication-configmaps">Streaming Replication ConfigMaps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/40-building-the-pg-stateful-set/streaming-replication-sfs-init">Initializing the StatefulSet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/40-building-the-pg-stateful-set/replication-user">Creating a Replication User</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/40-building-the-pg-stateful-set/verify-replication">Verifying the Replication</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/postgresql/postgresql-outro">Outro</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Secrets</h1></header><div class="markdown"><p>Secrets are represented as key value pair and thus are very similar to ConfigMaps. However, ConfigMaps are meant for non-sensitive configuration data aiming at making application code portable across environments. So - analog to ConfigMaps - <strong>Secrets are key value sets but for sensitive data</strong>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="types-of-secrets"></a>Types of Secrets<a aria-hidden="true" tabindex="-1" class="hash-link" href="#types-of-secrets" title="Direct link to heading">#</a></h2><p>&quot;Secrets should have a Type field to allow the Kubelet and other system components to take action based on the secret&#x27;s type.&quot; [4]</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="secret-types"></a>Secret Types<a aria-hidden="true" tabindex="-1" class="hash-link" href="#secret-types" title="Direct link to heading">#</a></h2><p>You may have noticed that - compared to the creation of ConfigMaps - there&#x27;s an additional argument named <code>generic</code>.</p><p>Secrets have an additional <code>type</code>-field that tells other Kubernetes components to deal with a particular Secret in a particular way.</p><p>The following Secret Types are often supported:</p><ul><li>Generic (Opaque)</li><li>Docker Registry</li><li>TLS</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="generic"></a>Generic<a aria-hidden="true" tabindex="-1" class="hash-link" href="#generic" title="Direct link to heading">#</a></h3><p><strong>The most common secret type is <code>generic</code> / <code>opaque</code></strong> and is meant for creating secrets from a local file, local directory or a fixed value as provided with a literal.</p><p>This lesson focuses the secret type <code>generic</code> and you will find practical examples below.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="tls"></a>TLS<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tls" title="Direct link to heading">#</a></h3><p>Kubernetes offers a tooling to manage TLS Certificates as proposed in the ACME draft [6].</p><p>Kubernetes:</p><blockquote><p>lets you provision TLS certificates signed by a Certificate Authority (CA) that you control. These CA and certificates can be used by your workloads to establish trust. [7]</p></blockquote><p>See [7] to learn more about managing TLS Certificates with Kubernetes as the topic is outside of this lesson.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="docker-registry"></a>Docker Registry<a aria-hidden="true" tabindex="-1" class="hash-link" href="#docker-registry" title="Direct link to heading">#</a></h3><p>So far all container images have been pulled from dockerhub[5], the Kubernetes default registry. Often there are reasons to use alternative container registries. One reason may be to chose a registry being within the same network as the Kubernetes cluster so that traffic of pulling container images is contained within the private network.</p><p>In the case a private registry is to be used Kubernetes has to authenticate requests issued towards the registry. This is the purpose of Docker Registry Secrets.</p><p>Creating Container Registry Secrets will be covered in a later lesson.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="creating-generic-secrets"></a>Creating Generic Secrets<a aria-hidden="true" tabindex="-1" class="hash-link" href="#creating-generic-secrets" title="Direct link to heading">#</a></h2><p>Generic Secrets is what most people associated with Secrets. They are often used to represent access credentials such as host, username and password sets.</p><p>The syntax for creating a <code>generic</code> Secret is close to creating a ConfigMap. They can be created from literals:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl create secret generic area51 --from-literal</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">are-we-alone</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">dontknow --from-literal</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">username</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">admin --from-literal</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">password</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">ooHao9oh</span></div></div></div></div></div><p>Or from files (or a mixture of both):</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl create secret generic area52 --from-file</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">./90-username.txt --from-file</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">AA-password.txt</span></div></div></div></div></div><p>Where <code>90-username.txt</code> may look like:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">fileadmin</span></div></div></div></div></div><p>And <code>AA-password.txt</code> contains a password in a single line:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">Gash1voh</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="accessing-secrets-using-kubectl"></a>Accessing Secrets Using <code>kubectl</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#accessing-secrets-using-kubectl" title="Direct link to heading">#</a></h2><p>Once created secrets can be listed as usual using <code>kubectl get</code>:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl get secrets</span></div></div></div></div></div><p>Note that Kubernetes refers to the generic type as <code>Opaque</code> which means that the Secret is a list of arbitrary key value pairs. This is in contrast to purpose bound types such as TLS and Docker Registry Secrets which are associated with additional behavior of the Kubernetes cluster.</p><p>In order to get more information about the Secret <code>kubectl describe</code> helps:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl describe secret area51</span></div></div></div></div></div><p>This won&#x27;t print the Secret&#x27;s values but it will show its metadata and keys.</p><p><strong>Secret values can be decoded</strong> by issuing:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl get secret area51 -o yaml</span></div></div></div></div></div><p>Generally speaking <strong>it is a bad idea to store secrets in a plain text file that can be purposely or accidentally checked into a source control system such as Git.</strong> Do not store your secrets outside of an encrypted password store. If you are aware of this and take care of excluding YAML definitions of your Secrets from source control, it is ok to have YAML files though.</p><p><strong>Did you recognize that the values of the Secret do not match the values that have been passed during their creation?</strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="editing-a-secret"></a>Editing a Secret<a aria-hidden="true" tabindex="-1" class="hash-link" href="#editing-a-secret" title="Direct link to heading">#</a></h2><p>Secrets can be edited by using:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl edit secrets area51</span></div></div></div></div></div><p>On most unix/linux computers this will open a local text editor open such as <code>vim</code> [8].</p><p>Saving the edited Secret will automatically <code>replace</code> the secret as if <code>kubectl replace</code> had been executed.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="exercise"></a>Exercise<a aria-hidden="true" tabindex="-1" class="hash-link" href="#exercise" title="Direct link to heading">#</a></h3><p><strong>Try to change the value corresponding to the key <code>username</code> and save it.</strong></p><p>Do you receive the following error?</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">error: secrets </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;area51&quot;</span><span class="token plain"> could not be patched: error decoding from json: illegal base64 data at input byte </span><span class="token number" style="color:rgb(247, 140, 108)">4</span></div></div></div></div></div><p>The reason why this command didn&#x27;t succeed is because <strong>Secret values are base64 encoded by Kubernetes</strong>. This is not encryption but at least it obfuscated values so that a brief look at them doesn&#x27;t tell the secret. This is not really safe but we&#x27;ll come back to this later. For now, just be aware that Secret values are base64 encoded and therefore <strong>pasting plain text values won&#x27;t work</strong> (well it may be possible to store the Secret but you&#x27;ll have trouble during decoding later).</p><p>So how can a string be base64 encoded? There are plenty of ways but on linux/unix machines this may do the trick:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token builtin class-name" style="color:rgb(255, 203, 139)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;test&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">|</span><span class="token plain"> base64</span></div></div></div></div></div><p>The resulting string can be pasted into the Secret during editting.</p><p>As with ConfigMaps changes to Secrets are automatically available in consuming Pods after a few seconds <strong>if the Secret has been mounted as a volume</strong>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="showing-a-secret-value"></a>Showing a Secret Value<a aria-hidden="true" tabindex="-1" class="hash-link" href="#showing-a-secret-value" title="Direct link to heading">#</a></h2><p>Assuming you have the command <code>base64</code> installed retrieving the decoded value from a Secret can be done with:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#d6deeb;background-color:#011627"><div class="token-line" style="color:#d6deeb"><span class="token plain">kubectl get secret area51 -o </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">jsonpath</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token string" style="color:rgb(173, 219, 103)">&quot;{.data.username}&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">|</span><span class="token plain"> base64 --decode</span></div></div></div></div></div><p>Where <code>username</code> is the key of the <code>area51</code> Secret to which the value should be retrieved and decoded.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="consuming-secrets-from-applications"></a>Consuming Secrets from Applications<a aria-hidden="true" tabindex="-1" class="hash-link" href="#consuming-secrets-from-applications" title="Direct link to heading">#</a></h2><p>Using Secrets from a Pod is similar to using ConfigMaps.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="exercise-1"></a>Exercise<a aria-hidden="true" tabindex="-1" class="hash-link" href="#exercise-1" title="Direct link to heading">#</a></h3><p>Use your new knowledge learned during the the ConfigMap lessons and:</p><ol><li>Create a Pod and consume the previously created Secret <code>area51</code> as environment variables.</li><li>Create a Pod and consume the previously created Secret <code>area52</code> as a mounted volume.</li></ol><p>Hints:</p><ol><li>Use <code>secretKeyRef</code> instead of <code>configKeyRef</code>.</li><li>Use <code>secret</code> instead of <code>configMap</code> when describing the <code>volume</code>. Also change <code>name</code> to <code>secretName</code> to refer to your Secret.</li><li>Read the Kubernetes documentation [3] if you want to see examplary Pod definitions.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="how-secret-secrets-are"></a>How Secret Secrets are<a aria-hidden="true" tabindex="-1" class="hash-link" href="#how-secret-secrets-are" title="Direct link to heading">#</a></h2><p>While Secrets are meant to deal with access credentials such as certificates and passwords, it surprises that - by default - <strong>Kubernetes stores Secrets into its etcd[1] data store without encryption</strong>. However, it is possible to configure a Kubernetes cluster to encrypt Secrets [2].</p><p><strong>Using Secrets makes it easier to apply encryption as a cluster wide setting</strong>. It is also to be expected that the handling of Secrets becomes more secure with future Kubernetes releaes.</p><p>Hence, <strong>even when Secrets are unencrypted, it is a best practise to use them</strong>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="links"></a>Links<a aria-hidden="true" tabindex="-1" class="hash-link" href="#links" title="Direct link to heading">#</a></h2><ol><li>etcd, <a href="https://etcd.io/" target="_blank" rel="noopener noreferrer">https://etcd.io/</a></li><li>Kubernetes Documentation, Tasks, Encrypting Secret Data at Rest, <a href="https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/</a></li><li>Kubernetes Documentation, Concepts, Secrets, <a href="https://kubernetes.io/docs/concepts/configuration/secret/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/concepts/configuration/secret/</a></li><li>Kubernetes Design Document, <a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/auth/secrets.md">https://github.com/kubernetes/community/blob/master/contributors/design-proposals/auth/secrets.md</a></li><li>dockerhub, <a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">https://hub.docker.com/</a></li><li>ACME - Automatic Certificate Management Environment, <a href="https://github.com/ietf-wg-acme/acme/" target="_blank" rel="noopener noreferrer">https://github.com/ietf-wg-acme/acme/</a></li><li>Kubernetes Documentation, Tasks, Manage TLS Certificates in a Cluster, <a href="https://kubernetes.io/docs/tasks/tls/managing-tls-in-a-cluster/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/tls/managing-tls-in-a-cluster/</a></li><li>Vim - The Ubiquitous Text Editor, <a href="https://www.vim.org/" target="_blank" rel="noopener noreferrer">https://www.vim.org/</a></li></ol></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kubernetes/60-configmaps-and-secrets/configmaps-volume-mounts"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« ConfigMap Volume Mounts</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kubernetes/60-configmaps-and-secrets/secrets-exercise-explanation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Secrets Exercise Explanation »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#types-of-secrets" class="table-of-contents__link">Types of Secrets</a></li><li><a href="#secret-types" class="table-of-contents__link">Secret Types</a><ul><li><a href="#generic" class="table-of-contents__link">Generic</a></li><li><a href="#tls" class="table-of-contents__link">TLS</a></li><li><a href="#docker-registry" class="table-of-contents__link">Docker Registry</a></li></ul></li><li><a href="#creating-generic-secrets" class="table-of-contents__link">Creating Generic Secrets</a></li><li><a href="#accessing-secrets-using-kubectl" class="table-of-contents__link">Accessing Secrets Using <code>kubectl</code></a></li><li><a href="#editing-a-secret" class="table-of-contents__link">Editing a Secret</a><ul><li><a href="#exercise" class="table-of-contents__link">Exercise</a></li></ul></li><li><a href="#showing-a-secret-value" class="table-of-contents__link">Showing a Secret Value</a></li><li><a href="#consuming-secrets-from-applications" class="table-of-contents__link">Consuming Secrets from Applications</a><ul><li><a href="#exercise-1" class="table-of-contents__link">Exercise</a></li></ul></li><li><a href="#how-secret-secrets-are" class="table-of-contents__link">How Secret Secrets are</a></li><li><a href="#links" class="table-of-contents__link">Links</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">More from anynines</h4><ul class="footer__items"><li class="footer__item"><a href="https://anynines.com/?utm_source=k8s-tutorial&amp;utm_medium=web" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://anynines.com/?utm_source=k8s-tutorial&amp;utm_medium=web">anynines.com</a></li><li class="footer__item"><a href="https://paas.anynines.com/?utm_source=k8s-tutorial&amp;utm_medium=web" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://paas.anynines.com/?utm_source=k8s-tutorial&amp;utm_medium=web">anynines PaaS</a></li><li class="footer__item"><a href="https://anynines.com/jobs/?utm_source=k8s-tutorial&amp;utm_medium=web" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://anynines.com/jobs/?utm_source=k8s-tutorial&amp;utm_medium=web">Jobs at anynines</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Follow us</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/anynines" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://twitter.com/anynines">Twitter</a></li><li class="footer__item"><a href="https://www.linkedin.com/company/anynines/" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://www.linkedin.com/company/anynines/">LinkedIn</a></li><li class="footer__item"><a href="https://instagram.com/anyninescom" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://instagram.com/anyninescom">Instagram</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.anynines.com/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://www.anynines.com/imprint">Imprint</a></li><li class="footer__item"><a href="https://www.anynines.com/data-privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item" to="https://www.anynines.com/data-privacy">Privacy Policy</a></li></ul></div></div><div class="text--center"><div>Copyright © 2021 anynines GmbH.</div></div></div></footer></div>
<script src="/styles.3e1a9644.js"></script>
<script src="/runtime~main.4b91e377.js"></script>
<script src="/main.43f40134.js"></script>
<script src="/1.040ff6b2.js"></script>
<script src="/2.9decab9e.js"></script>
<script src="/62.da6d2fa3.js"></script>
<script src="/61.482bd80b.js"></script>
<script src="/ec1ed54d.cede18ae.js"></script>
<script src="/17896441.6d66ffd8.js"></script>
<script src="/6cbc433d.3c96948e.js"></script>
</body>
</html>
<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Ingress | Kubernetes Training</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://learn.kubernetes.anynines.com/img/logo.svg"><meta data-react-helmet="true" name="twitter:image" content="https://learn.kubernetes.anynines.com/img/logo.svg"><meta data-react-helmet="true" property="og:url" content="https://learn.kubernetes.anynines.com/kubernetes/replicaset-and-service/ingress"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Ingress | Kubernetes Training"><meta data-react-helmet="true" name="description" content="Related Videos"><meta data-react-helmet="true" property="og:description" content="Related Videos"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://learn.kubernetes.anynines.com/kubernetes/replicaset-and-service/ingress"><link data-react-helmet="true" rel="alternate" href="https://learn.kubernetes.anynines.com/kubernetes/replicaset-and-service/ingress" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://learn.kubernetes.anynines.com/kubernetes/replicaset-and-service/ingress" hreflang="x-default"><script data-react-helmet="true" id="oil-configuration" type="application/configuration">
          {
            "config_version": 1,
            "publicPath": "/",
            "advanced_settings": true,
            "default_to_optin": true,
            "gdpr_applies_globally": true,
            "timeout": -1,
            "local_url": "/oils-de.json",
            "iabVendorListUrl": "/vendorlist.json",
            "customVendorListUrl": "/vendors.json",
          }
        </script><script data-react-helmet="true" src="/oilstub.1.3.5-SNAPSHOT.min.js"></script><script data-react-helmet="true" src="/oil.1.3.5-SNAPSHOT.min.js"></script><link rel="stylesheet" href="/assets/css/styles.f7ace848.css">
<link rel="preload" href="/assets/js/runtime~main.6971e47d.js" as="script">
<link rel="preload" href="/assets/js/main.408ef476.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/training-overview"><img src="/img/logoLight.svg" alt="anynines" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="anynines" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Kubernetes Training</b></a><a class="navbar__item navbar__link" href="/containerization/container-overview">Container Training</a><a class="navbar__item navbar__link" href="/kubernetes/kubernetes-overview">Kubernetes Training</a><a class="navbar__item navbar__link" href="/postgresql/postgresql-overview">PostgreSQL on Kubernetes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/anynines/a9s-kubernetes-training" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Fork me<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/anynines" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://paas.anynines.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>anynines PaaS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Containerization</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Kubernetes</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/kubernetes-overview">Kubernetes Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Basics</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Pods</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">ReplicaSets and Services</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/replicaset-and-service/introduction">ReplicaSets and Services</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/replicaset-and-service/replicasets">ReplicaSets</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/replicaset-and-service/services">Services</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kubernetes/replicaset-and-service/ingress">Ingress</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/replicaset-and-service/tidyup">Tidying Up</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Deployments</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">ConfigMaps and Secrets</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Jobs</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">StatefulSets</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">PostgreSQL on Kubernetes</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Ingress</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="related-videos"></a>Related Videos<a class="hash-link" href="#related-videos" title="Direct link to heading">#</a></h2><div style="padding-top:10px;padding-bottom:1.8em"><style data-emotion="css 1tz8m30">.css-1tz8m30{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin-top:-32px;width:calc(100% + 32px);margin-left:-32px;}.css-1tz8m30>.MuiGrid-item{padding-top:32px;}.css-1tz8m30>.MuiGrid-item{padding-left:32px;}</style><div class="jss1 MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-4 css-1tz8m30"><style data-emotion="css 1085lws">.css-1085lws{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}@media (min-width:600px){.css-1085lws{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:1200px){.css-1085lws{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}</style><div class="jss1 MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-lg-4 css-1085lws"><div style="padding-bottom:56.25%;padding-top:0;position:relative;height:0;border-radius:4px;overflow:hidden;margin-bottom:14px"><iframe class="fadedVideo" style="width:100%;height:100%;top:0;left:0;position:absolute" width="320" src="https://www.youtube-nocookie.com/embed/7MmJQpoPr4s?rel=0&amp;modestbranding=1&amp;playsinline=0&amp;controls=2" title="YouTube video player" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><style data-emotion="css u7ipk">.css-u7ipk{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.57;letter-spacing:0.00714em;font-weight:800;}</style><h6 class="jss2 MuiTypography-root MuiTypography-subtitle2 css-u7ipk">Ingress Part 1</h6></div><div class="jss1 MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-lg-4 css-1085lws"><div style="padding-bottom:56.25%;padding-top:0;position:relative;height:0;border-radius:4px;overflow:hidden;margin-bottom:14px"><iframe class="fadedVideo" style="width:100%;height:100%;top:0;left:0;position:absolute" width="320" src="https://www.youtube-nocookie.com/embed/KV3XheQDRuk?rel=0&amp;modestbranding=1&amp;playsinline=0&amp;controls=2" title="YouTube video player" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><h6 class="jss2 MuiTypography-root MuiTypography-subtitle2 css-u7ipk">Ingress Part 2</h6></div><div class="jss1 MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-lg-4 css-1085lws"><div style="padding-bottom:56.25%;padding-top:0;position:relative;height:0;border-radius:4px;overflow:hidden;margin-bottom:14px"><iframe class="fadedVideo" style="width:100%;height:100%;top:0;left:0;position:absolute" width="320" src="https://www.youtube-nocookie.com/embed/0QpZL6NOam4?rel=0&amp;modestbranding=1&amp;playsinline=0&amp;controls=2" title="YouTube video player" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><h6 class="jss2 MuiTypography-root MuiTypography-subtitle2 css-u7ipk">Ingress Part 3</h6></div></div><style data-emotion="css 39bbo6">.css-39bbo6{margin:0;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;border-width:0;border-style:solid;border-color:rgba(0, 0, 0, 0.12);border-bottom-width:thin;}</style><hr class="jss3 MuiDivider-root MuiDivider-fullWidth css-39bbo6" style="padding-top:1.8em"></div><p>Pods and ReplicaSets can be used to start and operate containers. Services can be handy to provide named access to and distribute and load balance requests across Pods, <strong>internally</strong>.</p><p>Most application systems have a public facing interface, too. In order to expose a web service or web application to outside world, an additional Kubernetes resource comes is useful: <strong>the Ingress</strong>.</p><p>In contrast to Kubernetes Services which operate on layer 4 (transport) of the <a href="https://en.wikipedia.org/wiki/OSI_model" target="_blank" rel="noopener noreferrer">ISO OSI model</a>, Ingresses operate on layer 7 (application). This means that an Ingress knows the HTTP protocol and is able to read and interpret incoming HTTP requests enabling a number of additional options. A major benefit is the ability to create <strong>virtual hosts</strong>.</p><p>Virtual hosts address the challenge of pointing multiple domain names to a single IP address in a way that the &quot;web server&quot; is able to map domain names to the corresponding applications.</p><p>So with the Ingress concept it is possible to map incoming requests based on the desired domain contained in the HTTP Header to applications running within Kubernetes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="ingress-is-not-built-in-to-kubernetes"></a>Ingress is not Built-In to Kubernetes<a class="hash-link" href="#ingress-is-not-built-in-to-kubernetes" title="Direct link to heading">#</a></h2><p>While Ingress is a Kubernetes concept, there is no built-in Kubernetes implementation. In Kubernetes terminology: <strong>Kubernetes does not ship with a default Ingress Controller</strong>. Therefore, each Kubernetes implementation may come with a different Ingress Controller which in turn may offer slightly different features and configuration options, but generally they are likely to cover the same core functionality.</p><p>One reason for this is that load balancing is a non-trivial problem to solve. It is used to enable highly available applications and is related to topics such as networking, DNS and SSL certificate management.</p><p>At some point there must be one or more highly available load balancers distributing incoming requests. These load balancers can be Kubernetes or infrastructure (e.g. AWS) provided software load balancers or even good old hardware appliances.</p><p>As a takeaway, it is worth spending a few minutes on looking at a particular Ingress implementation when using a particular Kubernetes distribution for the first time.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="dns-entries-and-ssl-certificates"></a>DNS Entries and SSL Certificates<a class="hash-link" href="#dns-entries-and-ssl-certificates" title="Direct link to heading">#</a></h3><p>It is easy to use <code>kubectl proxy</code> to access Kubernetes workloads as it does not require much configuration. However, exposing an application to the outside world usually requires the configuration of a domain or subdomain dedicated to the application such as <code>myapp.example.org</code>.</p><p>This is why Kubernetes can&#x27;t do much for you as controlling DNS entries is out of its scope and so is requesting and issuing SSL certificates, but in the latter case there are extensions to help you to do so.</p><p>For the creation of DNS entries you might want to create:</p><ul><li>An <strong>A-Record</strong> to point a (sub-)domain to the IP address of your load balancer.</li><li>A <strong>CNAME-Record</strong> to point a (sub-)domain to the DNS name of your load balancer.</li></ul><p>The configuration of DNS entries varies across DNS providers. Their manuals will guide you through the process.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="creating-local-dns-entries-for-minikube"></a>Creating local DNS entries for minikube<a class="hash-link" href="#creating-local-dns-entries-for-minikube" title="Direct link to heading">#</a></h3><p>When using minikube you can create a local DNS entry by editing your
<code>/etc/hosts</code> and pointing it to your minikube IP address. This way a DNS entry is created that is solely present on your computer, which will redirect requests of the specified URL to your running minikube cluster.</p><p>If you are running minikube on a hypervisor different from Docker you can get the minikube IP by executing :</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">minikube </span><span class="token function" style="color:rgb(130, 170, 255)">ip</span><span class="token plain"> </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>With Docker, you will have to set up a tunnel, that will expose your cluster at <code>127.0.0.1</code>, for that use</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">minikube tunnel</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Now we have to add the DNS entry to our hosts file, execute </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">nano</span><span class="token plain"> /etc/hosts</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The basic editor <code>nano</code> will now be used to open the file (Note: you can only navigate using keyboard inputs),
there navigate to the end of the file and create your new entry for <code>myapp.example.org</code> by inserting</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1 myapp.example.org</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Substitute <code>127.0.0.1</code> by your minikube IP address if you are not using docker. Then press <code>^X</code> and <code>Y</code> to save &amp; exit.</p><blockquote><p>Note: The IP of minikube might change if you restart it, so make sure to check your DNS entries if something does not work.</p></blockquote><p>Now if you navigate to <code>myapp.example.org</code> in your browser, the traffic will be redirected to minikube.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="creating-a-self-signed-ssl-certificate"></a>Creating a Self-Signed SSL Certificate<a class="hash-link" href="#creating-a-self-signed-ssl-certificate" title="Direct link to heading">#</a></h2><p>Securing websites with SSL encryption (<code>HTTPS</code> instead of <code>HTTP</code>) [1] has become a defacto standard. Therefore, it is worth dealing with the additional complexity here and show how an application on Kubernetes can be SSL encrypted.</p><p>First, it should be mentioned that the termination of the SSL certificate happens within the Ingress controller, in this example the <code>ngninx</code> ingress [2][3]. While most of this training has been applicable to most Kubernetes flavors, the Ingress is often specific to a particular Kubernetes distribution. So be prepared to search the documentation in case you want to apply this tutorial to a different Kubernetes cluster.</p><p>In order to enable the Ingress controller to terminate an SSL certificate, you either have to create one. If you want to get a free SSL certificate that will be ok for most browsers and surely better than a self-signed certificate have a look at <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Let&#x27;s Encrypt [4]</a>.</p><p>For this example, a self-signed certificate will be good enough as the process of setting up the certificate is the same for trusted certificates.</p><p>Assuming you have installed <code>openssl</code> creating a self-signed SSL certificate for the domain <code>myapp.example.org</code> can be achieved by issuing the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">openssl req -x509 -nodes -days </span><span class="token number" style="color:rgb(247, 140, 108)">365</span><span class="token plain"> -newkey rsa:2048 -keyout k9s.key -out k9s.crt -subj </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;/CN=myapp.example.org /O=myapp.example.org&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will create the files <code>k9s.key</code> and <code>k9s.crt</code> which you will need during the creation of a TLS Secret.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="creating-the-tls-secret"></a>Creating the TLS Secret<a class="hash-link" href="#creating-the-tls-secret" title="Direct link to heading">#</a></h2><p>Creating a TLS Secret is straight forward:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl create secret tls k9s-anynines-com-tls --key k9s.key --cert k9s.crt</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will read the files <code>k9s.key</code> and <code>k9s.crt</code>. As you can see the TLS Secret is a special type of Kubernetes Secret. Secrets will be covered in a later lesson in greater detail. For now, it&#x27;s enough to know that a Secret is a set of key-value pairs managed by the Kubernetes API and stored in the Kubernetes etcd. The TLD Secret is special in so far that its keys are fixed to <code>key</code> and <code>cert</code>. This ensures that the Ingress knows where to look for both the key and certificate requires to utilize the SSL certificate.</p><p>Check whether the Secret has been created successfully:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl get secrets</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And describe it:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl describe secret k9s-anynines-com-tls</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should see an output similar to:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">Name:         k9s-anynines-com-tls</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Namespace:    k8s-training</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Labels:       </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Annotations:  </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Type:  kubernetes.io/tls</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Data</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token operator" style="color:rgb(127, 219, 202)">==</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">tls.crt:  </span><span class="token number" style="color:rgb(247, 140, 108)">1322</span><span class="token plain"> bytes</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">tls.key:  </span><span class="token number" style="color:rgb(247, 140, 108)">1704</span><span class="token plain"> bytes</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You can see that both the key and certificate have been stored as <code>tls.crt</code> and <code>tls.key</code>. The Ingress controller will then retrieve these files by mounting them as files.</p><p>Now you are ready to create the actual Ingress object.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="creating-an-ingress"></a>Creating an Ingress<a class="hash-link" href="#creating-an-ingress" title="Direct link to heading">#</a></h2><p>On an a9s Kubernetes cluster creating an Ingress can be done by creating the file <code>40-ingress-hello-world-a9s.yaml</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> networking.k8s.io/v1</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Ingress</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> smpl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">go</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">web</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">ingress</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token key atrule">annotations</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic"># use the shared ingress-nginx</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token key atrule">kubernetes.io/ingress.class</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&quot;nginx&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token key atrule">tls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">hosts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> myapp.example.org</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token key atrule">secretName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> k9s</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">anynines</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">com</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">tls</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token key atrule">rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> myapp.example.org</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token key atrule">http</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token key atrule">paths</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token key atrule">pathType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Prefix</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">        </span><span class="token key atrule">backend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">          </span><span class="token key atrule">service</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> smpl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">go</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">web</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">s</span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">            </span><span class="token key atrule">port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#d6deeb"><span class="token plain">              </span><span class="token key atrule">number</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Again: You may have to search the documentation of your Kubernetes cluster as the Ingress may require a different specification.</p><p>You can also see that <code>annotations</code> contains an element <code>kubernetes.io/ingress.class: &quot;nginx&quot;</code> declaring that the <code>nginx</code>-Ingress is to be used.</p><p>The <code>tls</code> section declares a list of hosts, in this case the domain <code>myapp.example.org</code>. Recognized how the SSL certificate for the domain is passed to the Ingress as a Secret with <code>secretName: k9s-anynines-com-tls</code>. As the TLS Secret type has a well known structure no further arguments are required.</p><p>Lastly, the actual web application is connected to the Ingress by mounting the application to the path <code>/</code>. When using many microservice apps, it can be handy to mount a set of microservices to a domain which will create the impression of a single application to the outside user. In our case, there is only one application. Note that there is no reference to a Pod, ReplicaSet or Deployment. Instead, the reference is to a Service <code>smpl-go-web-s</code> and its port <code>8080</code>.</p><p>The Ingress is responsible for mapping external HTTP requests to particular applications. This connection is done by the Service. In other words: the Ingress - a layer 7 proxy - read the HTTP requests, extracts the host information and maps the incoming request to a layer 4 load balancer - the Service which in turn distributes the requests across its endpoints. In this case, our singe instance web app.</p><p>Apply it:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl apply -f </span><span class="token number" style="color:rgb(247, 140, 108)">40</span><span class="token plain">-ingress-hello-world-a9s.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In order to verify whether the Ingress has been created list existing Ingresses:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl get ingress</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the output you can obtain the URL in the <code>HOSTS</code> attribute it may look similar to <code>myapp.example.org</code>.</p><p>Since our certificate is self-signed, if you navigate to <code>https://myapp.example.org</code>, your browser will warn you that you
are using an insecure site and might not let you visit the page. You can still verify that everything is working by using</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> --insecure  https://myapp.example.org/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Congratulations! You have successfully deployed a web application.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="links"></a>Links<a class="hash-link" href="#links" title="Direct link to heading">#</a></h2><ol><li>Google Guidelines, Secure your site with HTTPS, <a href="https://support.google.com/webmasters/answer/6073543?hl=en" target="_blank" rel="noopener noreferrer">https://support.google.com/webmasters/answer/6073543?hl=en</a></li><li>Nginx, <a href="https://nginx.org" target="_blank" rel="noopener noreferrer">https://nginx.org</a></li><li>Nginx Ingress, <a href="https://kubernetes.github.io/ingress-nginx/" target="_blank" rel="noopener noreferrer">https://kubernetes.github.io/ingress-nginx/</a></li><li>Let&#x27;s Encrypt, <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">https://letsencrypt.org/</a></li><li>OpenSSL, <a href="https://www.openssl.org/" target="_blank" rel="noopener noreferrer">https://www.openssl.org/</a></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/kubernetes/replicaset-and-service/services"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Services</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/kubernetes/replicaset-and-service/tidyup"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tidying Up Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#related-videos" class="table-of-contents__link">Related Videos</a></li><li><a href="#ingress-is-not-built-in-to-kubernetes" class="table-of-contents__link">Ingress is not Built-In to Kubernetes</a><ul><li><a href="#dns-entries-and-ssl-certificates" class="table-of-contents__link">DNS Entries and SSL Certificates</a></li><li><a href="#creating-local-dns-entries-for-minikube" class="table-of-contents__link">Creating local DNS entries for minikube</a></li></ul></li><li><a href="#creating-a-self-signed-ssl-certificate" class="table-of-contents__link">Creating a Self-Signed SSL Certificate</a></li><li><a href="#creating-the-tls-secret" class="table-of-contents__link">Creating the TLS Secret</a></li><li><a href="#creating-an-ingress" class="table-of-contents__link">Creating an Ingress</a></li><li><a href="#links" class="table-of-contents__link">Links</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">More from anynines</h4><ul class="footer__items"><li class="footer__item"><a href="https://anynines.com/?utm_source=k8s-tutorial&amp;utm_medium=web" target="_blank" rel="noopener noreferrer" class="footer__link-item">anynines.com</a></li><li class="footer__item"><a href="https://paas.anynines.com/?utm_source=k8s-tutorial&amp;utm_medium=web" target="_blank" rel="noopener noreferrer" class="footer__link-item">anynines PaaS</a></li><li class="footer__item"><a href="https://anynines.com/jobs/?utm_source=k8s-tutorial&amp;utm_medium=web" target="_blank" rel="noopener noreferrer" class="footer__link-item">Jobs at anynines</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Follow us</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/anynines" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.linkedin.com/company/anynines/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li><li class="footer__item"><a href="https://instagram.com/anyninescom" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.anynines.com/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint</a></li><li class="footer__item"><a href="https://www.anynines.com/data-privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2022 anynines GmbH.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.6971e47d.js"></script>
<script src="/assets/js/main.408ef476.js"></script>
</body>
</html>
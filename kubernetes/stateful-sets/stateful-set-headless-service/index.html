<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-kubernetes/stateful-sets/stateful-set-headless-service">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Headless Service | Kubernetes Training</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://learn.kubernetes.anynines.com/img/logo.svg"><meta data-rh="true" name="twitter:image" content="https://learn.kubernetes.anynines.com/img/logo.svg"><meta data-rh="true" property="og:url" content="https://learn.kubernetes.anynines.com/kubernetes/stateful-sets/stateful-set-headless-service"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Headless Service | Kubernetes Training"><meta data-rh="true" name="description" content="Related Videos"><meta data-rh="true" property="og:description" content="Related Videos"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://learn.kubernetes.anynines.com/kubernetes/stateful-sets/stateful-set-headless-service"><link data-rh="true" rel="alternate" href="https://learn.kubernetes.anynines.com/kubernetes/stateful-sets/stateful-set-headless-service" hreflang="en"><link data-rh="true" rel="alternate" href="https://learn.kubernetes.anynines.com/kubernetes/stateful-sets/stateful-set-headless-service" hreflang="x-default"><script id="usercentrics-cmp" src="https://app.usercentrics.eu/browser-ui/latest/loader.js" data-settings-id="ptaGMQQHY" async></script>
<script type="text/plain" src="https://www.googletagmanager.com/gtag/js?id=GTM-5XSJGVJ" data-usercentrics="Google Tag Manager" async></script><link rel="stylesheet" href="/assets/css/styles.ace922d2.css">
<link rel="preload" href="/assets/js/runtime~main.8fd55986.js" as="script">
<link rel="preload" href="/assets/js/main.5ffd00a9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logoLight.svg" alt="anynines" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="anynines" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Kubernetes Training</b></a><a class="navbar__item navbar__link" href="/containerization/container-overview">Container Training</a><a class="navbar__item navbar__link" href="/kubernetes/kubernetes-overview">Kubernetes Training</a><a class="navbar__item navbar__link" href="/postgresql/postgresql-overview">PostgreSQL on Kubernetes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/anynines/a9s-kubernetes-training" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Fork me<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/anynines" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://paas.anynines.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">anynines PaaS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/containerization/container-overview">Containerization</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/kubernetes/kubernetes-overview">Kubernetes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/kubernetes-overview">Kubernetes Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/kubernetes/basics/prerequisite">Basics</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/kubernetes/pods/introduction">Pods</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/kubernetes/replicaset-and-service/introduction">ReplicaSets and Services</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/kubernetes/deployments/deployments">Deployments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/kubernetes/configmaps-and-secrets/configmaps-and-secrets">ConfigMaps and Secrets</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/kubernetes/jobs/jobs">Jobs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/kubernetes/stateful-sets/persistent-volumes">StatefulSets</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/stateful-sets/persistent-volumes">Persistent Volumes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/stateful-sets/persistent-volumes-exercise">Persistent Volumes Excercise</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/stateful-sets/stateful-sets">StatefulSets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/stateful-sets/stateful-set-postgresql">PostgreSQL StatefulSet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kubernetes/stateful-sets/stateful-set-headless-service">Headless Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/stateful-sets/stateful-set-vs-replicasets">StatefulSet vs. ReplicaSets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/stateful-sets/stateful-set-psql-access-to-postgresql">PSQL Access to PostgreSQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/stateful-sets/stateful-set-application-access">Application Access to a StatefulSet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kubernetes/stateful-sets/stateful-set-conclusions">Conclusions</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/postgresql/postgresql-overview">PostgreSQL on Kubernetes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/changelog">About</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Kubernetes</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">StatefulSets</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Headless Service</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Headless Service</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="related-videos">Related Videos<a class="hash-link" href="#related-videos" title="Direct link to heading">​</a></h2><div style="padding-top:10px;padding-bottom:1.8em"><style data-emotion="css 1tz8m30">.css-1tz8m30{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin-top:-32px;width:calc(100% + 32px);margin-left:-32px;}.css-1tz8m30>.MuiGrid-item{padding-top:32px;}.css-1tz8m30>.MuiGrid-item{padding-left:32px;}</style><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-4 css-1tz8m30"><style data-emotion="css 1px0r2z">.css-1px0r2z{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}@media (min-width:600px){.css-1px0r2z{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:900px){.css-1px0r2z{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:1200px){.css-1px0r2z{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}@media (min-width:1536px){.css-1px0r2z{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-lg-4 css-1px0r2z"><div style="padding-bottom:56.25%;padding-top:0;position:relative;height:0;border-radius:4px;overflow:hidden;margin-bottom:14px"><iframe class="fadedVideo" style="width:100%;height:100%;top:0;left:0;position:absolute" width="320" src="https://www.youtube-nocookie.com/embed/6IoZCGSxI7Y?rel=0&amp;modestbranding=1&amp;playsinline=0&amp;controls=2" title="YouTube video player" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><style data-emotion="css u7ipk">.css-u7ipk{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.57;letter-spacing:0.00714em;font-weight:800;}</style><h6 class="MuiTypography-root MuiTypography-subtitle2 css-u7ipk">Headless Services</h6></div></div></div><hr><p>Once you have create the PostgreSQL StatefulSet you may want to access it with an application. The next lessons will therefore evolve towards application access, step by step.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-statefulset-and-its-headless-service">The StatefulSet and its Headless Service<a class="hash-link" href="#the-statefulset-and-its-headless-service" title="Direct link to heading">​</a></h2><p>In the previous chapter you have learned that a StatefulSet has a stable network identity. As mentioned before, the PostgreSQL StatefulSet will be accessed by an application. As applications may change during version updates or being rescheduled in the Cluster, so could be Pods of a StatefulSet. With both the application Deployments and the StatefulSet being fast moving targets, it is the StatefulSet&#x27;s headless Service providing a stable entry point for the application to reach out to the PostgreSQL StatefulSet.</p><p>Have a look at what you have created in the previous lesson:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl describe </span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> postgresql-svc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Shows that the headless Service <code>postgresql-svc</code> has the label <code>Labels: app=postgresql-a</code>.</p><p>And:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl describe </span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> postgresql-svc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Produces an output similar to:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">Name:              postgresql-svc</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Namespace:         k8s-training</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Labels:            </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">app</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">postgresql-a</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Annotations:       Selector:  </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">app</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">postgresql-a</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Type:              ClusterIP</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">IP:                None</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Port:              postgresql-port  </span><span class="token number" style="color:rgb(247, 140, 108)">5432</span><span class="token plain">/TCP</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">TargetPort:        </span><span class="token number" style="color:rgb(247, 140, 108)">5432</span><span class="token plain">/TCP</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Endpoints:         </span><span class="token number" style="color:rgb(247, 140, 108)">172.17</span><span class="token plain">.0.5:5432</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Session Affinity:  None</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Events:            </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which shows <code>Annotations: Selector:  app=postgresql-a</code> indicating that the Service is connected to the StatefulSet through the Label <code>app=postgresql-a</code>. You can see that in the <code>Endpoints: 172.17.0.5:5432</code> line which refers to the Pod <code>postgresql-sfs-0</code> of the StatefulSet <code>postgresql-sfs</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl describe pod kubectl describe postgresql-sfs-0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The output shows that the Pod <code>postgresql-sfs-0</code> has the <code>IP: 172.17.0.5</code> which means that the Pod is set as the endpoint of the headless Service.</p><p>This means that a DNS entry will be created pointing directly to the Pods associated with the Service.</p><p>Verify this by executing:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl describe </span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> postgresql-svc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which reveals that the headless Service <code>postgresql-svc</code> has the label <code>Labels: app=postgresql-a</code>.</p><p>And:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl describe </span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> postgresql-svc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Produces an output similar to:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">Name:              postgresql-svc</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Namespace:         k8s-training</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Labels:            </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">app</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">postgresql-a</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Annotations:       Selector:  </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">app</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">postgresql-a</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Type:              ClusterIP</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">IP:                None</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Port:              postgresql-port  </span><span class="token number" style="color:rgb(247, 140, 108)">5432</span><span class="token plain">/TCP</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">TargetPort:        </span><span class="token number" style="color:rgb(247, 140, 108)">5432</span><span class="token plain">/TCP</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Endpoints:         </span><span class="token number" style="color:rgb(247, 140, 108)">172.17</span><span class="token plain">.0.5:5432</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Session Affinity:  None</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Events:            </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This shows <code>Annotations: Selector:  app=postgresql-a</code> indicating that the Service is connected to the StatefulSet through the Label <code>app=postgresql-a</code>. You can see that in the <code>Endpoints: 172.17.0.5:5432</code> line which refers to the Pod <code>postgresql-sfs-0</code> of the StatefulSet <code>postgresql-sfs</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl describe pod kubectl describe postgresql-sfs-0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The output shows that the Pod <code>postgresql-sfs-0</code> has the <code>IP: 172.17.0.5</code> which means that the Pod is set as the endpoint of the headless Service.</p><p>Along with the headless Service <code>postgresql-svc</code> Kubernetes will create a cluster-internal DNS entry: <code>postgresql-svc.k8s-training.svc.cluster.local</code>.</p><p><strong>Go and see yourself!</strong></p><p>First, get inside the cluster by launching a utility Pod:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl run -i --tty nspct --image</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">fischerjulian/nspct --restart</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">Never -- </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>nspct</code> image provides a few handy tools such as <code>nslookup</code> - a utility to query nameservers.</p><p>Inside the <code>nspct</code> Pod check whether the resolver can resolve the service URL:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">nslookup</span><span class="token plain"> postgresql-svc.k8s-training.svc.cluster.local</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which will produce a response similar to:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">Server:     </span><span class="token number" style="color:rgb(247, 140, 108)">10.96</span><span class="token plain">.0.10</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Address:    </span><span class="token number" style="color:rgb(247, 140, 108)">10.96</span><span class="token plain">.0.10</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#53</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Name:    postgresql-svc.k8s-training.svc.cluster.local</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Address: </span><span class="token number" style="color:rgb(247, 140, 108)">172.17</span><span class="token plain">.0.5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So the DNS entry has been created and resolves to the IP address of the only Pod inside the StatefulSet.</p><p>Hence, the headless Service provides a stable network identity for the StatefulSet as the Service couples to the StatefulSet loosely by using a selector in the Service referring to the label <code>app=postgresql-a</code> in the StatefulSet.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="headless-service-for-statefulsets-with-multiple-replicas">Headless Service for StatefulSets with Multiple Replicas<a class="hash-link" href="#headless-service-for-statefulsets-with-multiple-replicas" title="Direct link to heading">​</a></h2><p>With a single Pod (<code>replicas: 1</code>) in a StatefulSet the mapping from the headless Service to the Pod is unambiguous: <code>service -&gt; Pod</code>.</p><p>This raises the question <strong>what happens if there are multiple Pods in the StatefulSet?</strong></p><p>Let&#x27;s try it!</p><p>First, we need a StatefulSet with multiple replicas. So we modify the StatefulSet definition of the previous example by <strong>editing</strong> the file <code>30-stateful-set.yaml</code>.</p><p>Within <code>30-stateful-set.yaml</code> change <code>replicas: 1</code> to <code>replicas: 3</code>. Save the file and apply it:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl apply -f </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain">-stateful-set.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will update the existing StatefulSet <code>postgresql-sfs</code> and you should see the number of Pods increase from 1 to 3:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl get statefulsets</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Of course, <strong>this StatefulSet does not constitute a functioning PostgreSQL cluster</strong>, but that&#x27;s alright. All that matters here is the number of Pods to see show the relationship between the number of replicas and the headless Service.</p><p>Now check on the Service again:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl describe </span><span class="token function" style="color:rgb(130, 170, 255)">service</span><span class="token plain"> postgresql-svc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which should produce an output similar to:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">Name:              postgresql-svc</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Namespace:         k8s-training</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Labels:            </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">app</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">postgresql-a</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Annotations:       Selector:  </span><span class="token assign-left variable" style="color:rgb(214, 222, 235)">app</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">postgresql-a</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Type:              ClusterIP</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">IP:                None</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Port:              postgresql-port  </span><span class="token number" style="color:rgb(247, 140, 108)">5432</span><span class="token plain">/TCP</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">TargetPort:        </span><span class="token number" style="color:rgb(247, 140, 108)">5432</span><span class="token plain">/TCP</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Endpoints:         </span><span class="token number" style="color:rgb(247, 140, 108)">172.17</span><span class="token plain">.0.5:5432,172.17.0.7:5432,172.17.0.8:5432</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Session Affinity:  None</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Events:            </span><span class="token operator" style="color:rgb(127, 219, 202)">&lt;</span><span class="token plain">none</span><span class="token operator" style="color:rgb(127, 219, 202)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Pay attention how the <code>Endpoints</code> attribute of the Service has changed without touching the Service explicitly. It now has 3 instead of endpoint: <code>172.17.0.5:5432,172.17.0.7:5432,172.17.0.8:5432</code>.</p><p><strong>So what does the existence of two additional endpoints imply for the DNS configuration</strong>? It means that now the mapping from the Service <code>postgresql-svc</code> ambiguous. It&#x27;s not a 1:1 but a 1:3 mapping. So let&#x27;s figure out what this means by running another utility Pod:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">kubectl run -i --tty nspct --image</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">fischerjulian/nspct --restart</span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain">Never -- </span><span class="token function" style="color:rgb(130, 170, 255)">bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Within the utility Pod perform another domain lookup:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token function" style="color:rgb(130, 170, 255)">nslookup</span><span class="token plain"> postgresql-svc.k8s-training.svc.cluster.local</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Which this time will produce:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">Server:     </span><span class="token number" style="color:rgb(247, 140, 108)">10.96</span><span class="token plain">.0.10</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Address:    </span><span class="token number" style="color:rgb(247, 140, 108)">10.96</span><span class="token plain">.0.10</span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">#53</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Name:   postgresql-svc.k8s-training.svc.cluster.local</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Address: </span><span class="token number" style="color:rgb(247, 140, 108)">172.17</span><span class="token plain">.0.7</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Name:   postgresql-svc.k8s-training.svc.cluster.local</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Address: </span><span class="token number" style="color:rgb(247, 140, 108)">172.17</span><span class="token plain">.0.5</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Name:   postgresql-svc.k8s-training.svc.cluster.local</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">Address: </span><span class="token number" style="color:rgb(247, 140, 108)">172.17</span><span class="token plain">.0.8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As you can see all StatefulSet Pods are present in the response.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="links">Links<a class="hash-link" href="#links" title="Direct link to heading">​</a></h2><ol><li>PostgreSQL Docker Image at Docker Hub, <a href="https://hub.docker.com/_/postgres" target="_blank" rel="noopener noreferrer">https://hub.docker.com/_/postgres</a></li><li>Kubernetes Examples on GitHub, Persistent Volume Provisioning, <a href="https://github.com/kubernetes/examples/blob/master/staging/persistent-volume-provisioning/README.md" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/examples/blob/master/staging/persistent-volume-provisioning/README.md</a></li><li>PostgreSQL Documentation - psql, <a href="https://www.postgresql.org/docs/12/app-psql.html" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/docs/12/app-psql.html</a></li><li>Kelsey Hightower @ Twitter, <a href="https://twitter.com/kelseyhightower/status/935252923721793536?lang=en" target="_blank" rel="noopener noreferrer">https://twitter.com/kelseyhightower/status/935252923721793536?lang=en</a></li><li>Cloud Foundry, <a href="https://www.cloudfoundry.org/" target="_blank" rel="noopener noreferrer">https://www.cloudfoundry.org/</a></li><li>Open Service Broker API, <a href="https://www.openservicebrokerapi.org/" target="_blank" rel="noopener noreferrer">https://www.openservicebrokerapi.org/</a></li><li>anynines, a9s Data Services, <a href="https://www.anynines.com/data-services" target="_blank" rel="noopener noreferrer">https://www.anynines.com/data-services</a></li><li>Kubernetes Documentation, Concepts, ServiceCatalog, <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/service-catalog/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/concepts/extend-kubernetes/service-catalog/</a></li><li>Wikipedia, Principle of Least Privilege, <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Principle_of_least_privilege</a></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/kubernetes/stateful-sets/stateful-set-postgresql"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">PostgreSQL StatefulSet</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kubernetes/stateful-sets/stateful-set-vs-replicasets"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">StatefulSet vs. ReplicaSets</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#related-videos" class="table-of-contents__link toc-highlight">Related Videos</a></li><li><a href="#the-statefulset-and-its-headless-service" class="table-of-contents__link toc-highlight">The StatefulSet and its Headless Service</a></li><li><a href="#headless-service-for-statefulsets-with-multiple-replicas" class="table-of-contents__link toc-highlight">Headless Service for StatefulSets with Multiple Replicas</a></li><li><a href="#links" class="table-of-contents__link toc-highlight">Links</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">More from anynines</h4><ul class="footer__items"><li class="footer__item"><a href="https://anynines.com/?utm_source=k8s-tutorial&amp;utm_medium=web" target="_blank" rel="noopener noreferrer" class="footer__link-item">anynines.com</a></li><li class="footer__item"><a href="https://paas.anynines.com/?utm_source=k8s-tutorial&amp;utm_medium=web" target="_blank" rel="noopener noreferrer" class="footer__link-item">anynines PaaS</a></li><li class="footer__item"><a href="https://anynines.com/jobs/?utm_source=k8s-tutorial&amp;utm_medium=web" target="_blank" rel="noopener noreferrer" class="footer__link-item">Jobs at anynines</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Follow us</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/anynines" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.linkedin.com/company/anynines/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li><li class="footer__item"><a href="https://instagram.com/anyninescom" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.anynines.com/imprint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint</a></li><li class="footer__item"><a href="https://www.anynines.com/data-privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li></ul></div></div><div class="text--center"><div>Copyright © 2023 anynines GmbH.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8fd55986.js"></script>
<script src="/assets/js/main.5ffd00a9.js"></script>
</body>
</html>